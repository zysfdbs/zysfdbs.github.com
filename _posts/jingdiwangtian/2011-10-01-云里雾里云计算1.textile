---
layout: post
title:  邓侃：云里雾里云计算
category: 井底望天
---

2010-05-09 02:27:51

h1. 【引言】

*俺这个 "博客":http://blog.sina.com.cn/skyinwell ，写了不少政治经济和文化的东西，虽然对科技稍有涉及，但是因为自己的能力限制，因此很多东西未免隔山打牛。而大家估计光是看政治经济的东西，未免有点闷了。因此这里就准备增加一些科技的内容，以达到更好的普及知识的目的。*

*大家都知道，其实俺是在IT这一行混口饭吃，而且现在还是吃的云计算这碗饭。所以这里就找到了邓侃兄弟关于云计算的一系列宏文，拿来给大家阅读。如果大家觉得这类文章很好，以后俺会多多转载，并在时间允许的情况下，也写一些给和大家共勉。*


有一次去开会，台上的人在讲云计算。我问身边的听众，“听懂了吗？感觉如何？”

听众答，“云里雾里的，感觉特神秘。”

我说，“这说明讲员讲得好。有没有注意到寺庙里的气氛也很神秘？ *不神秘，就没有崇拜。不崇拜，你怎么肯掏钱买香火？* ”

h1. 【1】云计算要解决什么问题？

1997年，Google的两位创始人，Larry Page和Sergey Brin，找Andy Bechtolsheim募集投资。

Andy问，“你们打算做什么？”

Larry和Sergey答，“打算把互联网上所有网页都下载，然后建一个搜索引擎。”

Andy说，”把互联网上所有网页统统下载？！需要多大空间？几个Giga不行吧，几个Tera也不行吧，几个Peta，几个Zetta？。。。嗯，我看几个Googol也许才能撑得住。知道Googol吗？就是10的100次方，就是一个1后面拖100个0！”

估计是Andy觉得这个项目不太靠谱，所以给的钱不多，只有1百万美元。只有这么一点钱，如果去买高端的存储系统，显然是不够的。走投无路的情况下，Larry和Sergey决定用PC之类便宜的机器，组建一个机器集群。先凑合着用，等以后数据量增加以后，再购买更多的PCs，扩大集群的容量。

这个故事的真实性，有待考证。但是从中可以看到Google集群，也就是Google云计算的核心，要解决的四个问题。

1. 大规模的存储空间，用于存储海量的数据。

2. 随着业务的发展，新的数据源源不断地增加，存储空间需要相应扩大。用术语讲，这叫可扩展性，scalability。

3. 系统的硬件设备必须便宜，通常使用大宗产品（commodity），譬如PC，或者价格便宜，中等性能的Dell server。

4. 便宜的硬件设备，经常死机。所以在设计这个集群的时候，必须保证不能因为个别机器死机，导致整个系统的崩溃。也就是系统的稳定性要好，reliability。


h1. 【2】从Google集群到云计算，云计算的商业模式

起初Google集群是供内部使用的系统。Google为什么要开放这个系统，包装成云计算平台，给外界使用呢？

这要从Google的商业模式说起。Google的绝大多数收入来自于广告，其它产品和服务的收入十分有限。其它产品包括Google盒子，这是给企业内部网用的搜索引擎。把Google盒子安装到企业内部网，企业员工就可以搜索企业内部的文档，包括可以公开的文档，也包括仅供企业内部查阅的资料。虽然技术很新颖，但是卖得并不好。据ZDNet的报道，2008年度，Google盒子的收益，占Google总利润的份额，不到2%。

!/images/jingdiwangtian/Google_search_appliance.jpeg!


Google search appliance, 俗称Google盒子。

Courtesy http://farm3.static.flickr.com/2629/4066641796_f2192dcc6b_o.jpg

单一的收入来源，抗风险的能力差。譬如经济危机一来，各个企业的广告预算缩减，势必影响到Google的利润。怎么办？挖掘自身的优势，发现更多卖点，搞多种经营。

Google的技术优势在哪里？有人说，Google的搜索结果精确，所以PageRanking算法是其精髓。其实，算法容易模仿复制，即使几年前 PageRanking是Google的独家秘籍，但是今日各大搜索引擎，都有类似算法。

*{color:red}让Google独步天下的是它的集群。* 2006年，Google集群的规模是45万台机器。两年过去了，有人推测现在的规模又翻了一番。由于Google从不公布准确数字，所以大家只能靠Google给硬件厂商下的订单推测。

推测虽然不准确，但是即便是10万台机器的规模，在历史上也是从无古人的，在当代也是独一无二的。而且，更重要的是这个超大规模的集群系统已经经历了10年的实际运行，在实践中被证明，它是可靠的，是可扩展的，每台机器的价格也是低廉的。完全符合上一节列举的四个要求。

但是如何依靠这个独门神器挣钱呢？思路有两条。

1.  做hosting，数据托管。其它企业不用建自己的数据中心了，把数据存在Google的集群里得了，每个月交点托管费。

2.  不少Google的应用服务很有人气，譬如Gmail，Gtalk，Reader，Online docs，Picasa，Google earth还有YouTube等等。这些服务对于个人用户而言，完全是免费的。但是Google从来没有说给企业用户使用，也是免费的。譬如某家商店，开了一个网站，网站上需要贴很多照片，还要给个地图给顾客引路。这个商店不需要自己动手建照片存储中心，也不需要开发技术难度更高的地图软件，只要调用 Google提供的相关服务就好。商店建网站是为了赢利，所以Google当然要向商店收钱。

第二个思路还有个副产品，那就是给Google创造更高的流量。流量越大，说明观众越多。对于广告商来说，哪里观众多，就愿意在哪里投放广告。所以，如果第二个思路能给Google带来更高流量，那么会吸引更多的广告，给Google带来更多的广告收入。

Google的高管们一合计，觉得有钱途。于是乎，大张旗鼓地制造舆论，educate the market。

造舆论，讲究的是措辞的简练，气势的磅礴。这个新的服务叫什么? 用工程师的语言，准确地定义，应当是“超大规模的，可扩展的，低成本，但是高可靠性的服务器集群系统”。Google市场部的人一听，头摇得像拨浪鼓。不行不行，既不简练，也没有气势。

研究来研究去，于是乎，“云计算cloud computing” 这个概念粉墨登场了。

h1. 【3】Google云计算的矛头指向谁？

有一次听一位IT业长者指点江山。长者说，“Google像一个阳光少年，一路顺风顺雨，张张扬扬。让人羡慕，招人喜欢。而微软像一个稳健的中年人，一路风吹雨打，过五关斩六将，毁誉参半。对于它的支持者而言，它是令人敬重的领袖，对于它的竞争者而言，它是令人敬重的对手，无论如何，微软是令人敬重的。”

问及电脑的killer applications，长者说了三个，1. Email，2. Office产品系列，包括Word，Excel和PPT等，3. Web。Email和Web都是泛称，不特指某家公司的产品，但是Office系列是微软公司的产品。长者这样的表述，足见他对微软的推崇。

很少有人不知道微软，但是很少有人很了解微软。随便问两个问题，1. 微软哪一年成立的，2. 微软在哪个城市成立的，有多少人答得上来？

*微软是在1975年4月，于新墨西哥州的Albuquerque市成立的，后来搬到了华盛顿州的西雅图市郊。* 从那时到2008年6月30日，Bill Gates掌舵了33年。然后把CEO的宝座让给了Steve Ballmer，自己则专心致志去散钱搞慈善去了。

Bill Gates舍得捐出自己绝大部分家产，这个心胸让所有地球人叹服。但是Bill为了保证他的基金会平稳运转，自己退休的同时，让微软一员老将，Jeff Raikes跟着他离开微软，出任基金会的CEO。Jeff Raikes离职，对于微软而言，是不可估量的损失。为什么这么讲？

微软有三个产品系列，

1. 大家熟悉的XBox游戏机，是微软the Entertainment and Devices Division的拳头产品。这个部门是微软从单纯的软件公司，扩张到家电行业的触角。虽然XBox的成功毋庸置疑，但是它能不能给微软带来丰厚的利润，是摆在这个部门，尤其是其掌门人，Robbie Bach面前的巨大挑战。

2. The Platforms and Services Division，去年7月份被一分为二。一个专注于改善Windows操作系统，另一个负责在线服务。原来的掌门人，Kevin Johnson，挥挥衣袖离开微软，去Juniper Networks出任CEO。

新的两位掌门人中，有一位是我们中国人，毕业于复旦大学的陆奇。从复旦毕业后，陆奇留学美国CMU，攻读博士学位。博士学位拿到后，经历了短暂的动荡，1998年陆奇加盟Yahoo。他从工程师干起，扎扎实实，一路升到副总裁。2009年1月，陆奇学长离开Yahoo，出任微软Online Services Group的president。他的职责是，领导微软对抗Google。

2009年，争夺互联网霸主的大戏正式开演。

!/images/jingdiwangtian/陆奇博士.jpeg(陆奇博士)!

3. 对于Windows操作系统的评价，好坏参半。但是对于Microsoft Office系列产品，业界基本上交口称赞。负责Office部门的原掌门人，就是刚才提到的Jeff Raikes。

!/images/jingdiwangtian/Jeff_Raikes.jpeg(Jeff Raikes)!

2009年上演互联网争霸赛，微软与Google双方的战略意图相当明显。

1. 微软以陆奇为主帅，强攻Google的核心业务，网络搜索。

2. Google砸重金推广云计算，挑战微软的拳头产品，Outlook email系统，和Office产品系列。

攻防战的关键，在于寻找对方的软肋。

[1] Microsoft Outlook vs Google Gmail

Microsoft outlook email系统的软肋，在于它的后台系统不够稳定，容量也不容易扩展。对于用户而言，经常会遇到Outlook服务器联系不上，以及存储空间不够的麻烦。

看准这两点，Google把Gmail系统的号召力定位在，1. 稳定性，2. 无限的存储空间。Google之所以敢于这么叫阵，本钱就在于云计算平台。

当然微软也不会示弱，它们反制的着力点在于保密性。

譬如有一家企业叫foobar，Google的销售人员游说到，“别用Outlook了吧，那玩意儿经常掉线，而且隔三岔五地骚扰你说，存储空间没有了，请立刻删除不必要的emails。你的emails都很重要，怎么能删呢？用我们的gmail吧。”

Foobar公司的IT主管说，“我们公司的邮箱地址是@foobar.com，换成@gmail.com，不仅不方便，而且也有损于我们公司技术实力的形象。”

Google的销售人员说，“不用换邮箱地址，表面上看仍然是@foobar.com，用户也可以继续使用Outlook桌面工具，但是后台服务器被悄悄地换成了Gmail的云计算平台。”

Foobar公司的IT主管心思有点动摇。

这时候，微软的销售人员上门，说到，“听说你们想把email后台系统换成gmail？这可需要一点勇气。你们把公司所以emails，存放在 Google的平台上，万一Googler偷窥你们的emails，贵公司的商业机密，。。啊，哈哈。”

所以，为Google进言，欲挑战微软outlook，必先解决gmail的保密性。也就是其它公司的emails虽然存放在Google的云计算平台，但是Google能够提供足够的技术保证，即便是Googler有意偷窥，他们也看不到。

[2] Microsoft Office vs Google Docs

Microsoft office 产品的软肋，在于所有文件存放在电脑本地。

譬如我在办公室写了一个设计草稿，通过email把文本发给一个同事审阅。晚上回家后，查看email，收到同事回复，说他做了一些文字上的改正，修订版本放在email的附件中，同时建议多加几个插图。我加了几个插图后，文件尺寸变得很大，email发了很久，还是没有顺利发出。于是我把文件存在U盘上，第二天上班后，拿给同事看，然后进一步修改。

Google的销售人员游说到，“你这样左一个文本，右一个文本，不仅不容易找，而且修改过的内容很容易遗漏。用Google Docs，就可以省掉所有这些麻烦。文本放在Google云计算平台上，无论你是在办公室里，还是在家里，你都可以对同一份文本进行修改。而且你可以与你的同事共享这个文本，让他也可以对同一份文本进行修改。”

我问，“万一我不同意同事的修改怎么办？”

Google的销售人员回答，“没关系，就像wiki一样，所有修改都有记录。如果需要，你可以恢复旧版本。还有，如果你需要查找几年前你写的另一份文件，你不必记住名字，只要一搜索就可以从故纸堆里找出来。”

于是我心旌动摇，准备建议领导把公司的设计文档全部放到Google Docs里去。这时候，微软的销售人员上门了。“听说你要建议把公司所有机密设计文件，转移到Google Docs中去？不怕Googler偷看呀？”

我说，“Google已经提供了解决方案，给我们所有文件加了密，密钥掌握在我们手里。即便Googler想偷看，他们也看不到。”

微软的销售人员说，“这样就好，安全第一。另外，你们的设计文档格式很简单吗？示意图怎么画，Google Docs有类似于微软Visio那样的工具吗？还有，如果你要比较两份不同的文件有什么差异，Google Docs有没有微软Word那样‘比较与合并’ 等等功能？”

微软反制的着力点在于，Google Docs的所有操作都在浏览器里完成，所有功能都通过JavaScript实现。受制于JavaScript的限制，Google Docs在功能上，不仅目前赶不上Microsoft Office，而且预计在相当长的未来，也不可能与之抗衡。

h1. 【4】云计算大战，Google出招

两军对垒，通常双方阵线连绵数十公里。在发动进攻的时候，很少出现全线推进的情况。相反，进攻往往出现在有限几个突击口上。集结强大兵力，在几个突击口上猛烈打击，期望在敌方阵线撕开缺口，然后向敌方纵深挺进，分割敌人阵线，再逐个合围，各个击破。

!/images/jingdiwangtian/巴巴罗萨战役.png(巴巴罗萨战役 Operation Barbarossa)!

大公司之间竞争也有类似特点，双方都有很多产品和服务，而且功能类似，这就像战争中两军对峙的阵线。当一个公司向对手发动竞争攻势的时候，往往选择少数几个产品，大做广告和其它市场推销活动，以期迅速扩大在相关市场的占有率。这类似于在战争中，选择突破口，集结兵力，发动冲击，企图撕开敌军阵线。

譬如Google Docs，虽说它上线已有相当时日，但是从没有见到Google大规模宣传这个服务。所以Google Docs与Microsoft Office，是对峙的阵线，而不是发动进攻的突击口。

Google在云计算战役中，选择的突破口是什么产品和服务呢？答案，Google gadgets。

!/images/jingdiwangtian/Google_gadgets.gif(Google gadgets)!

Google gadgets简化了建网站的工作。每个网页可以视作多个元素集成，譬如上面显示的网页包含6个元素，从左上到右下分别是天气，时钟，日历，YouTube视频，生活小窍门，以及搜索。网页元素，portlet，这个概念早在1999年就已经出现。Google gadgets是portlets的一种实现方式，与其它实现方式相比，Google gadgets的优势是使用方便。

譬如某人想建一个网站，在网站的首页的下方，想插入一个搜索框。他不用担心如何去实现隐藏在页面背后的搜索引擎，他要做的，仅仅是在网页的HTML里，插入几行JavaScript。这几行JavaScript，不仅在页面上显示了一个搜索框，而且更重要的是把这个网页与Google的云计算平台联系在一起。每当用户输入搜索请求时，这段JavaScript就把用户的请求，转发给Google搜索引擎，然后接收Google搜索到的结果，并显示在网页上。

*Google gadgets的意义在于，不再像以往的产品那样，在电脑本地获取服务和内容。* Google gadgets的服务和内容，来自于Google云计算平台。譬如以往的时钟，显示的时间是由电脑自己演算出来的。如果系统设置错误，时钟就有可能出错。但是Google gadget的时钟，它的时间不是电脑本地演算的，而是从Google云计算平台索取的。只要Google云计算平台不出错，只要网络链接正常，即便电脑本身的设置出了问题，Google gadget时钟也照样准确。

Google gadgets不仅可以给建网站的人提供便利，基于同样原理，Google又推出了Google desktop gadgets。它给千千万万普通的电脑使用者，带来多样化的，时尚的服务。

!{width:600px}/images/jingdiwangtian/Google_desktop_gadgets.jpeg(Google desktop gadgets)!

有人说，Google gadgets让电脑弱智。因为一旦Google gadgets大行其道，电脑就无需强大的CPU和存储空间，它所需要的无非是浏览器，接收用户的请求，转发给Google云计算平台，云计算平台提供内容和服务，然后浏览器接收这些来自云计算平台的内容和服务结果，并且把它们显示给用户。

其实，企图让电脑弱智的，不仅仅是Google云计算，早在1996年，Oracle总裁Larry Ellison就提出过网络电脑（Network computer）的构想。网络电脑的功能，仅限于浏览器，而内容和服务来自于网络服务器端。与Google云计算平台不同的是，Larry的构想是，网络服务器端最好是Oracle的数据库以及Oracle的应用服务器。

十多年过去了，Larry的构想没有成为现实，原因有三，

1.  Network computer的卖点是便宜，因为与传统PC相比，NC无需昂贵的CPU，内存和硬盘。但是近十年来，PC的价格迅速下跌，NC的卖点失去了吸引力。

2.  Larry Ellison设想的，以Oracle Database为核心的网络服务器，没有提供很好的可扩展性，也没有提供大量的有吸引力的应用。

3.  网络带宽的发展，没有超过PC计算能力的发展。

十年后的今日，以Google云计算平台为代表的网络服务器集群，比Oracle Database有了长足的改进。不仅可扩展性更好，而且Google提供了很多能吸引人的服务，譬如搜索，视频（YouTube），地图等等。

同时，虽然网络带宽的发展没有超越PC计算能力的发展，但是至少在很多地区，网络带宽不再是制约网络服务发展的瓶颈。

Network computer失败的三条原因中，两条发生了变化，所以，Google拾起老概念，换上新包装，向微软发起攻势。其战略目标，无非是弱化PC本地计算能力的重要性，增强对Google云计算平台的依赖性。

下一步Google gadgets的发展方向是什么？

请注意，目前绝大多数gadgets都是单向使用Google云计算平台所提供的内容和服务，而缺少促进用户上传新的内容和新的服务的gadgets。

所以，不妨大胆预测一下，Google下一步将非常热衷推出像论坛（forum），维基网页（wikipage）这样的gadgets。通过它们，促进用户给Google云计算平台上传用户生成的数据。

进一步，Google将投入巨大资源，发展AppEngine。AppEngine的用处是方便用户开发新的服务逻辑，并且在云计算平台上运行这些新的服务。但是AppEngine的开发，势必遇到很多技术上的困难。详细分析，我们留给下一篇来讨论。

 

*【评论】* 邓侃兄关于AppEngine的评论，一针见血。前几天在这上面玩了一下，觉得技术上还有待提高。

